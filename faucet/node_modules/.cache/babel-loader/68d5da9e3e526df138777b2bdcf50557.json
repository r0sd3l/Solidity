{"ast":null,"code":"import { Stream } from '../../stream/Stream.js';\nimport { NextArbitrary } from '../../check/arbitrary/definition/NextArbitrary.js';\nimport { NextValue } from '../../check/arbitrary/definition/NextValue.js';\nimport { biasNumericRange, bigIntLogLike } from './helpers/BiasNumericRange.js';\nimport { shrinkBigInt } from './helpers/ShrinkBigInt.js';\nexport class BigIntArbitrary extends NextArbitrary {\n  constructor(min, max) {\n    super();\n    this.min = min;\n    this.max = max;\n  }\n\n  generate(mrng, biasFactor) {\n    const range = this.computeGenerateRange(mrng, biasFactor);\n    return new NextValue(mrng.nextBigInt(range.min, range.max), undefined);\n  }\n\n  computeGenerateRange(mrng, biasFactor) {\n    if (biasFactor === undefined || mrng.nextInt(1, biasFactor) !== 1) {\n      return {\n        min: this.min,\n        max: this.max\n      };\n    }\n\n    const ranges = biasNumericRange(this.min, this.max, bigIntLogLike);\n\n    if (ranges.length === 1) {\n      return ranges[0];\n    }\n\n    const id = mrng.nextInt(-2 * (ranges.length - 1), ranges.length - 2);\n    return id < 0 ? ranges[0] : ranges[id + 1];\n  }\n\n  canShrinkWithoutContext(value) {\n    return typeof value === 'bigint' && this.min <= value && value <= this.max;\n  }\n\n  shrink(current, context) {\n    if (!BigIntArbitrary.isValidContext(current, context)) {\n      const target = this.defaultTarget();\n      return shrinkBigInt(current, target, true);\n    }\n\n    if (this.isLastChanceTry(current, context)) {\n      return Stream.of(new NextValue(context, undefined));\n    }\n\n    return shrinkBigInt(current, context, false);\n  }\n\n  defaultTarget() {\n    if (this.min <= 0 && this.max >= 0) {\n      return BigInt(0);\n    }\n\n    return this.min < 0 ? this.max : this.min;\n  }\n\n  isLastChanceTry(current, context) {\n    if (current > 0) return current === context + BigInt(1) && current > this.min;\n    if (current < 0) return current === context - BigInt(1) && current < this.max;\n    return false;\n  }\n\n  static isValidContext(current, context) {\n    if (context === undefined) {\n      return false;\n    }\n\n    if (typeof context !== 'bigint') {\n      throw new Error(`Invalid context type passed to BigIntArbitrary (#1)`);\n    }\n\n    const differentSigns = current > 0 && context < 0 || current < 0 && context > 0;\n\n    if (context !== BigInt(0) && differentSigns) {\n      throw new Error(`Invalid context value passed to BigIntArbitrary (#2)`);\n    }\n\n    return true;\n  }\n\n}","map":{"version":3,"sources":["C:/Users/rodri/Solidity/solidity/faucet/node_modules/fast-check/lib/esm/arbitrary/_internals/BigIntArbitrary.js"],"names":["Stream","NextArbitrary","NextValue","biasNumericRange","bigIntLogLike","shrinkBigInt","BigIntArbitrary","constructor","min","max","generate","mrng","biasFactor","range","computeGenerateRange","nextBigInt","undefined","nextInt","ranges","length","id","canShrinkWithoutContext","value","shrink","current","context","isValidContext","target","defaultTarget","isLastChanceTry","of","BigInt","Error","differentSigns"],"mappings":"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","sourcesContent":["import { Stream } from '../../stream/Stream.js';\nimport { NextArbitrary } from '../../check/arbitrary/definition/NextArbitrary.js';\nimport { NextValue } from '../../check/arbitrary/definition/NextValue.js';\nimport { biasNumericRange, bigIntLogLike } from './helpers/BiasNumericRange.js';\nimport { shrinkBigInt } from './helpers/ShrinkBigInt.js';\nexport class BigIntArbitrary extends NextArbitrary {\n    constructor(min, max) {\n        super();\n        this.min = min;\n        this.max = max;\n    }\n    generate(mrng, biasFactor) {\n        const range = this.computeGenerateRange(mrng, biasFactor);\n        return new NextValue(mrng.nextBigInt(range.min, range.max), undefined);\n    }\n    computeGenerateRange(mrng, biasFactor) {\n        if (biasFactor === undefined || mrng.nextInt(1, biasFactor) !== 1) {\n            return { min: this.min, max: this.max };\n        }\n        const ranges = biasNumericRange(this.min, this.max, bigIntLogLike);\n        if (ranges.length === 1) {\n            return ranges[0];\n        }\n        const id = mrng.nextInt(-2 * (ranges.length - 1), ranges.length - 2);\n        return id < 0 ? ranges[0] : ranges[id + 1];\n    }\n    canShrinkWithoutContext(value) {\n        return typeof value === 'bigint' && this.min <= value && value <= this.max;\n    }\n    shrink(current, context) {\n        if (!BigIntArbitrary.isValidContext(current, context)) {\n            const target = this.defaultTarget();\n            return shrinkBigInt(current, target, true);\n        }\n        if (this.isLastChanceTry(current, context)) {\n            return Stream.of(new NextValue(context, undefined));\n        }\n        return shrinkBigInt(current, context, false);\n    }\n    defaultTarget() {\n        if (this.min <= 0 && this.max >= 0) {\n            return BigInt(0);\n        }\n        return this.min < 0 ? this.max : this.min;\n    }\n    isLastChanceTry(current, context) {\n        if (current > 0)\n            return current === context + BigInt(1) && current > this.min;\n        if (current < 0)\n            return current === context - BigInt(1) && current < this.max;\n        return false;\n    }\n    static isValidContext(current, context) {\n        if (context === undefined) {\n            return false;\n        }\n        if (typeof context !== 'bigint') {\n            throw new Error(`Invalid context type passed to BigIntArbitrary (#1)`);\n        }\n        const differentSigns = (current > 0 && context < 0) || (current < 0 && context > 0);\n        if (context !== BigInt(0) && differentSigns) {\n            throw new Error(`Invalid context value passed to BigIntArbitrary (#2)`);\n        }\n        return true;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}