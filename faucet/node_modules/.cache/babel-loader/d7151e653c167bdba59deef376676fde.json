{"ast":null,"code":"import { NextArbitrary } from '../../check/arbitrary/definition/NextArbitrary.js';\nimport { NextValue } from '../../check/arbitrary/definition/NextValue.js';\nimport { makeLazy } from '../../stream/LazyIterableIterator.js';\nimport { Stream } from '../../stream/Stream.js';\nimport { isSubarrayOf } from './helpers/IsSubarrayOf.js';\nimport { IntegerArbitrary } from './IntegerArbitrary.js';\nexport class SubarrayArbitrary extends NextArbitrary {\n  constructor(originalArray, isOrdered, minLength, maxLength) {\n    super();\n    this.originalArray = originalArray;\n    this.isOrdered = isOrdered;\n    this.minLength = minLength;\n    this.maxLength = maxLength;\n    if (minLength < 0 || minLength > originalArray.length) throw new Error('fc.*{s|S}ubarrayOf expects the minimal length to be between 0 and the size of the original array');\n    if (maxLength < 0 || maxLength > originalArray.length) throw new Error('fc.*{s|S}ubarrayOf expects the maximal length to be between 0 and the size of the original array');\n    if (minLength > maxLength) throw new Error('fc.*{s|S}ubarrayOf expects the minimal length to be inferior or equal to the maximal length');\n    this.lengthArb = new IntegerArbitrary(minLength, maxLength);\n    this.biasedLengthArb = minLength !== maxLength ? new IntegerArbitrary(minLength, minLength + Math.floor(Math.log(maxLength - minLength) / Math.log(2))) : this.lengthArb;\n  }\n\n  generate(mrng, biasFactor) {\n    const lengthArb = biasFactor !== undefined && mrng.nextInt(1, biasFactor) === 1 ? this.biasedLengthArb : this.lengthArb;\n    const size = lengthArb.generate(mrng, undefined);\n    const sizeValue = size.value;\n    const remainingElements = this.originalArray.map((_v, idx) => idx);\n    const ids = [];\n\n    for (let index = 0; index !== sizeValue; ++index) {\n      const selectedIdIndex = mrng.nextInt(0, remainingElements.length - 1);\n      ids.push(remainingElements[selectedIdIndex]);\n      remainingElements.splice(selectedIdIndex, 1);\n    }\n\n    if (this.isOrdered) {\n      ids.sort((a, b) => a - b);\n    }\n\n    return new NextValue(ids.map(i => this.originalArray[i]), size.context);\n  }\n\n  canShrinkWithoutContext(value) {\n    if (!Array.isArray(value)) {\n      return false;\n    }\n\n    if (!this.lengthArb.canShrinkWithoutContext(value.length)) {\n      return false;\n    }\n\n    return isSubarrayOf(this.originalArray, value);\n  }\n\n  shrink(value, context) {\n    if (value.length === 0) {\n      return Stream.nil();\n    }\n\n    return this.lengthArb.shrink(value.length, context).map(newSize => {\n      return new NextValue(value.slice(value.length - newSize.value), newSize.context);\n    }).join(value.length > this.minLength ? makeLazy(() => this.shrink(value.slice(1), undefined).filter(newValue => this.minLength <= newValue.value.length + 1).map(newValue => new NextValue([value[0]].concat(newValue.value), undefined))) : Stream.nil());\n  }\n\n}","map":{"version":3,"sources":["C:/Users/rodri/Solidity/solidity/faucet/node_modules/fast-check/lib/esm/arbitrary/_internals/SubarrayArbitrary.js"],"names":["NextArbitrary","NextValue","makeLazy","Stream","isSubarrayOf","IntegerArbitrary","SubarrayArbitrary","constructor","originalArray","isOrdered","minLength","maxLength","length","Error","lengthArb","biasedLengthArb","Math","floor","log","generate","mrng","biasFactor","undefined","nextInt","size","sizeValue","value","remainingElements","map","_v","idx","ids","index","selectedIdIndex","push","splice","sort","a","b","i","context","canShrinkWithoutContext","Array","isArray","shrink","nil","newSize","slice","join","filter","newValue","concat"],"mappings":"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","sourcesContent":["import { NextArbitrary } from '../../check/arbitrary/definition/NextArbitrary.js';\nimport { NextValue } from '../../check/arbitrary/definition/NextValue.js';\nimport { makeLazy } from '../../stream/LazyIterableIterator.js';\nimport { Stream } from '../../stream/Stream.js';\nimport { isSubarrayOf } from './helpers/IsSubarrayOf.js';\nimport { IntegerArbitrary } from './IntegerArbitrary.js';\nexport class SubarrayArbitrary extends NextArbitrary {\n    constructor(originalArray, isOrdered, minLength, maxLength) {\n        super();\n        this.originalArray = originalArray;\n        this.isOrdered = isOrdered;\n        this.minLength = minLength;\n        this.maxLength = maxLength;\n        if (minLength < 0 || minLength > originalArray.length)\n            throw new Error('fc.*{s|S}ubarrayOf expects the minimal length to be between 0 and the size of the original array');\n        if (maxLength < 0 || maxLength > originalArray.length)\n            throw new Error('fc.*{s|S}ubarrayOf expects the maximal length to be between 0 and the size of the original array');\n        if (minLength > maxLength)\n            throw new Error('fc.*{s|S}ubarrayOf expects the minimal length to be inferior or equal to the maximal length');\n        this.lengthArb = new IntegerArbitrary(minLength, maxLength);\n        this.biasedLengthArb =\n            minLength !== maxLength\n                ? new IntegerArbitrary(minLength, minLength + Math.floor(Math.log(maxLength - minLength) / Math.log(2)))\n                : this.lengthArb;\n    }\n    generate(mrng, biasFactor) {\n        const lengthArb = biasFactor !== undefined && mrng.nextInt(1, biasFactor) === 1 ? this.biasedLengthArb : this.lengthArb;\n        const size = lengthArb.generate(mrng, undefined);\n        const sizeValue = size.value;\n        const remainingElements = this.originalArray.map((_v, idx) => idx);\n        const ids = [];\n        for (let index = 0; index !== sizeValue; ++index) {\n            const selectedIdIndex = mrng.nextInt(0, remainingElements.length - 1);\n            ids.push(remainingElements[selectedIdIndex]);\n            remainingElements.splice(selectedIdIndex, 1);\n        }\n        if (this.isOrdered) {\n            ids.sort((a, b) => a - b);\n        }\n        return new NextValue(ids.map((i) => this.originalArray[i]), size.context);\n    }\n    canShrinkWithoutContext(value) {\n        if (!Array.isArray(value)) {\n            return false;\n        }\n        if (!this.lengthArb.canShrinkWithoutContext(value.length)) {\n            return false;\n        }\n        return isSubarrayOf(this.originalArray, value);\n    }\n    shrink(value, context) {\n        if (value.length === 0) {\n            return Stream.nil();\n        }\n        return this.lengthArb\n            .shrink(value.length, context)\n            .map((newSize) => {\n            return new NextValue(value.slice(value.length - newSize.value), newSize.context);\n        })\n            .join(value.length > this.minLength\n            ? makeLazy(() => this.shrink(value.slice(1), undefined)\n                .filter((newValue) => this.minLength <= newValue.value.length + 1)\n                .map((newValue) => new NextValue([value[0]].concat(newValue.value), undefined)))\n            : Stream.nil());\n    }\n}\n"]},"metadata":{},"sourceType":"module"}