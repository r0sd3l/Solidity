{"ast":null,"code":"/**\n * Utilities for reformatting web3 outputs\n */\nconst BigNumber = require(\"bignumber.js/bignumber\");\n\nconst web3Utils = require(\"web3-utils\");\n/**\n * Converts from string to other number format\n * @param  {String} val    number string returned by web3\n * @param  {String} format name of format to convert to\n * @return {Object|String} converted value\n */\n\n\nconst _convertNumber = function (val, format) {\n  const badFormatMsg = `Attempting to convert to unknown number format: ${format}`;\n\n  switch (format) {\n    case \"BigNumber\":\n      return new BigNumber(val);\n\n    case \"BN\":\n      return web3Utils.toBN(val);\n\n    case \"String\":\n      return val;\n\n    default:\n      throw new Error(badFormatMsg);\n  }\n};\n/**\n * Converts arrays of number strings to other number formats\n * @param  {String[]} arr       number string array returned by web3\n * @param  {String}   format    name of format to convert to\n * @return {Object[]|String[]}  array of converted values\n */\n\n\nconst _convertNumberArray = function (arr, format) {\n  let depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  if (depth == 0) return arr.map(item => _convertNumber(item, format)); // arr is nested\n\n  return arr.map(item => _convertNumberArray(item, format, depth - 1));\n};\n/**\n * Reformats numbers in the result/result-object of a web3 call.\n * Possible forms of `result` are:\n *   - object (with index keys and optionally, named keys)\n *   - array\n *   - single primitive\n * @param  {String|Object|Array} result      web3 call result\n * @param  {Array}               abiSegment  event params OR .call outputs\n * @return {String|Object|Array} reformatted result\n */\n\n\nconst numbers = function (result, abiSegment) {\n  const format = this.numberFormat;\n  abiSegment.forEach((output, i) => {\n    // output is a number type (uint || int);\n    if (output.type.includes(\"int\")) {\n      // output is an array type\n      if (output.type.includes(\"[\")) {\n        // larger than zero if nested array\n        let depth = output.type.split(\"[\").length - 2; // result is array\n\n        if (Array.isArray(result)) {\n          result = _convertNumberArray(result, format, depth); // result is object\n        } else {\n          // output has name\n          if (output.name.length) {\n            result[output.name] = _convertNumberArray(result[output.name], format, depth);\n          } // output will always have an index key\n\n\n          result[i] = _convertNumberArray(result[i], format, depth);\n        } //\n\n      } else if (typeof result === \"object\") {\n        // output has name\n        if (output.name.length) {\n          result[output.name] = _convertNumber(result[output.name], format);\n        } // output will always have an index key\n\n\n        result[i] = _convertNumber(result[i], format);\n      } else {\n        result = _convertNumber(result, format);\n      }\n    }\n  });\n  return result;\n};\n\nmodule.exports = {\n  numbers: numbers\n};","map":{"version":3,"sources":["C:/Users/rodri/Solidity/solidity/faucet/node_modules/@truffle/contract/lib/reformat.js"],"names":["BigNumber","require","web3Utils","_convertNumber","val","format","badFormatMsg","toBN","Error","_convertNumberArray","arr","depth","map","item","numbers","result","abiSegment","numberFormat","forEach","output","i","type","includes","split","length","Array","isArray","name","module","exports"],"mappings":"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","sourcesContent":["/**\n * Utilities for reformatting web3 outputs\n */\nconst BigNumber = require(\"bignumber.js/bignumber\");\nconst web3Utils = require(\"web3-utils\");\n\n/**\n * Converts from string to other number format\n * @param  {String} val    number string returned by web3\n * @param  {String} format name of format to convert to\n * @return {Object|String} converted value\n */\nconst _convertNumber = function(val, format) {\n  const badFormatMsg = `Attempting to convert to unknown number format: ${format}`;\n\n  switch (format) {\n    case \"BigNumber\":\n      return new BigNumber(val);\n    case \"BN\":\n      return web3Utils.toBN(val);\n    case \"String\":\n      return val;\n    default:\n      throw new Error(badFormatMsg);\n  }\n};\n\n/**\n * Converts arrays of number strings to other number formats\n * @param  {String[]} arr       number string array returned by web3\n * @param  {String}   format    name of format to convert to\n * @return {Object[]|String[]}  array of converted values\n */\nconst _convertNumberArray = function(arr, format, depth = 0) {\n  if (depth == 0) return arr.map(item => _convertNumber(item, format));\n  // arr is nested\n  return arr.map(item => _convertNumberArray(item, format, depth - 1));\n};\n\n/**\n * Reformats numbers in the result/result-object of a web3 call.\n * Possible forms of `result` are:\n *   - object (with index keys and optionally, named keys)\n *   - array\n *   - single primitive\n * @param  {String|Object|Array} result      web3 call result\n * @param  {Array}               abiSegment  event params OR .call outputs\n * @return {String|Object|Array} reformatted result\n */\nconst numbers = function(result, abiSegment) {\n  const format = this.numberFormat;\n\n  abiSegment.forEach((output, i) => {\n    // output is a number type (uint || int);\n    if (output.type.includes(\"int\")) {\n      // output is an array type\n      if (output.type.includes(\"[\")) {\n        // larger than zero if nested array\n        let depth = output.type.split(\"[\").length - 2;\n\n        // result is array\n        if (Array.isArray(result)) {\n          result = _convertNumberArray(result, format, depth);\n\n          // result is object\n        } else {\n          // output has name\n          if (output.name.length) {\n            result[output.name] = _convertNumberArray(\n              result[output.name],\n              format,\n              depth\n            );\n          }\n          // output will always have an index key\n          result[i] = _convertNumberArray(result[i], format, depth);\n        }\n        //\n      } else if (typeof result === \"object\") {\n        // output has name\n        if (output.name.length) {\n          result[output.name] = _convertNumber(result[output.name], format);\n        }\n\n        // output will always have an index key\n        result[i] = _convertNumber(result[i], format);\n      } else {\n        result = _convertNumber(result, format);\n      }\n    }\n  });\n  return result;\n};\n\nmodule.exports = {\n  numbers: numbers\n};\n"]},"metadata":{},"sourceType":"script"}