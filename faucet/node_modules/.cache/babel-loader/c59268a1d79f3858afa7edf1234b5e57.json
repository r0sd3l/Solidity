{"ast":null,"code":"import { PreconditionFailure } from '../precondition/PreconditionFailure.js';\nimport { runIdToFrequency } from './IRawProperty.js';\nimport { readConfigureGlobal } from '../runner/configuration/GlobalParameters.js';\nimport { Stream } from '../../stream/Stream.js';\nimport { convertToNext } from '../arbitrary/definition/Converters.js';\nimport { noUndefinedAsContext, UndefinedContextPlaceholder } from '../../arbitrary/_internals/helpers/NoUndefinedAsContext.js';\nexport class AsyncProperty {\n  constructor(rawArb, predicate) {\n    this.predicate = predicate;\n    const {\n      asyncBeforeEach,\n      asyncAfterEach,\n      beforeEach,\n      afterEach\n    } = readConfigureGlobal() || {};\n\n    if (asyncBeforeEach !== undefined && beforeEach !== undefined) {\n      throw Error('Global \"asyncBeforeEach\" and \"beforeEach\" parameters can\\'t be set at the same time when running async properties');\n    }\n\n    if (asyncAfterEach !== undefined && afterEach !== undefined) {\n      throw Error('Global \"asyncAfterEach\" and \"afterEach\" parameters can\\'t be set at the same time when running async properties');\n    }\n\n    this.beforeEachHook = asyncBeforeEach || beforeEach || AsyncProperty.dummyHook;\n    this.afterEachHook = asyncAfterEach || afterEach || AsyncProperty.dummyHook;\n    this.arb = convertToNext(rawArb);\n  }\n\n  isAsync() {\n    return true;\n  }\n\n  generate(mrng, runId) {\n    const value = this.arb.generate(mrng, runId != null ? runIdToFrequency(runId) : undefined);\n    return noUndefinedAsContext(value);\n  }\n\n  shrink(value) {\n    if (value.context === undefined && !this.arb.canShrinkWithoutContext(value.value_)) {\n      return Stream.nil();\n    }\n\n    const safeContext = value.context !== UndefinedContextPlaceholder ? value.context : undefined;\n    return this.arb.shrink(value.value_, safeContext).map(noUndefinedAsContext);\n  }\n\n  async run(v) {\n    await this.beforeEachHook();\n\n    try {\n      const output = await this.predicate(v);\n      return output == null || output === true ? null : 'Property failed by returning false';\n    } catch (err) {\n      if (PreconditionFailure.isFailure(err)) return err;\n      if (err instanceof Error && err.stack) return `${err}\\n\\nStack trace: ${err.stack}`;\n      return `${err}`;\n    } finally {\n      await this.afterEachHook();\n    }\n  }\n\n  beforeEach(hookFunction) {\n    const previousBeforeEachHook = this.beforeEachHook;\n\n    this.beforeEachHook = () => hookFunction(previousBeforeEachHook);\n\n    return this;\n  }\n\n  afterEach(hookFunction) {\n    const previousAfterEachHook = this.afterEachHook;\n\n    this.afterEachHook = () => hookFunction(previousAfterEachHook);\n\n    return this;\n  }\n\n}\n\nAsyncProperty.dummyHook = () => {};","map":{"version":3,"sources":["C:/Users/rodri/Solidity/solidity/faucet/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js"],"names":["PreconditionFailure","runIdToFrequency","readConfigureGlobal","Stream","convertToNext","noUndefinedAsContext","UndefinedContextPlaceholder","AsyncProperty","constructor","rawArb","predicate","asyncBeforeEach","asyncAfterEach","beforeEach","afterEach","undefined","Error","beforeEachHook","dummyHook","afterEachHook","arb","isAsync","generate","mrng","runId","value","shrink","context","canShrinkWithoutContext","value_","nil","safeContext","map","run","v","output","err","isFailure","stack","hookFunction","previousBeforeEachHook","previousAfterEachHook"],"mappings":"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","sourcesContent":["import { PreconditionFailure } from '../precondition/PreconditionFailure.js';\nimport { runIdToFrequency } from './IRawProperty.js';\nimport { readConfigureGlobal } from '../runner/configuration/GlobalParameters.js';\nimport { Stream } from '../../stream/Stream.js';\nimport { convertToNext } from '../arbitrary/definition/Converters.js';\nimport { noUndefinedAsContext, UndefinedContextPlaceholder, } from '../../arbitrary/_internals/helpers/NoUndefinedAsContext.js';\nexport class AsyncProperty {\n    constructor(rawArb, predicate) {\n        this.predicate = predicate;\n        const { asyncBeforeEach, asyncAfterEach, beforeEach, afterEach } = readConfigureGlobal() || {};\n        if (asyncBeforeEach !== undefined && beforeEach !== undefined) {\n            throw Error('Global \"asyncBeforeEach\" and \"beforeEach\" parameters can\\'t be set at the same time when running async properties');\n        }\n        if (asyncAfterEach !== undefined && afterEach !== undefined) {\n            throw Error('Global \"asyncAfterEach\" and \"afterEach\" parameters can\\'t be set at the same time when running async properties');\n        }\n        this.beforeEachHook = asyncBeforeEach || beforeEach || AsyncProperty.dummyHook;\n        this.afterEachHook = asyncAfterEach || afterEach || AsyncProperty.dummyHook;\n        this.arb = convertToNext(rawArb);\n    }\n    isAsync() {\n        return true;\n    }\n    generate(mrng, runId) {\n        const value = this.arb.generate(mrng, runId != null ? runIdToFrequency(runId) : undefined);\n        return noUndefinedAsContext(value);\n    }\n    shrink(value) {\n        if (value.context === undefined && !this.arb.canShrinkWithoutContext(value.value_)) {\n            return Stream.nil();\n        }\n        const safeContext = value.context !== UndefinedContextPlaceholder ? value.context : undefined;\n        return this.arb.shrink(value.value_, safeContext).map(noUndefinedAsContext);\n    }\n    async run(v) {\n        await this.beforeEachHook();\n        try {\n            const output = await this.predicate(v);\n            return output == null || output === true ? null : 'Property failed by returning false';\n        }\n        catch (err) {\n            if (PreconditionFailure.isFailure(err))\n                return err;\n            if (err instanceof Error && err.stack)\n                return `${err}\\n\\nStack trace: ${err.stack}`;\n            return `${err}`;\n        }\n        finally {\n            await this.afterEachHook();\n        }\n    }\n    beforeEach(hookFunction) {\n        const previousBeforeEachHook = this.beforeEachHook;\n        this.beforeEachHook = () => hookFunction(previousBeforeEachHook);\n        return this;\n    }\n    afterEach(hookFunction) {\n        const previousAfterEachHook = this.afterEachHook;\n        this.afterEachHook = () => hookFunction(previousAfterEachHook);\n        return this;\n    }\n}\nAsyncProperty.dummyHook = () => { };\n"]},"metadata":{},"sourceType":"module"}